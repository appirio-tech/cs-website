/*
 * Author: Constantin Jucovschi (c.jucovschi@jacobs-university.de)
 * Licence: MIT
 */
CodeMirror.defineMode("stex",function(a,b){function c(a,b){a.cmdState.push(b)}function d(a){return a.cmdState.length>0?a.cmdState[a.cmdState.length-1]:null}function e(a){if(a.cmdState.length>0){var b=a.cmdState.pop();b.closeBracket()}}function f(a){var b=a.cmdState;for(var c=b.length-1;c>=0;c--){var d=b[c];if(d.name=="DEFAULT")continue;return d.styleIdentifier()}return null}function g(a,b,c,d){return function(){this.name=a,this.bracketNo=0,this.style=b,this.styles=d,this.brackets=c,this.styleIdentifier=function(a){return this.bracketNo<=this.styles.length?this.styles[this.bracketNo-1]:null},this.openBracket=function(a){return this.bracketNo++,"bracket"},this.closeBracket=function(a){}}}function i(a,b){a.f=b}function j(a,b){if(a.match(/^\\[a-z]+/)){var e=a.current();e=e.substr(1,e.length-1);var g=h[e];return typeof g=="undefined"&&(g=h.DEFAULT),g=new g,c(b,g),i(b,l),g.style}var j=a.next();if(j=="%")return i(b,k),"comment";if(j=="}"||j=="]"){g=d(b);if(g)g.closeBracket(j),i(b,l);else return"error";return"bracket"}return j=="{"||j=="["?(g=h.DEFAULT,g=new g,c(b,g),"bracket"):/\d/.test(j)?(a.eatWhile(/[\w.%]/),"atom"):(a.eatWhile(/[\w-_]/),f(b))}function k(a,b){return a.skipToEnd(),i(b,j),"comment"}function l(a,b){var c=a.peek();if(c=="{"||c=="["){var f=d(b),g=f.openBracket(c);return a.eat(c),i(b,j),"bracket"}return/[ \t\r]/.test(c)?(a.eat(c),null):(i(b,j),f=d(b),f&&e(b),j(a,b))}var h=new Array;return h.importmodule=g("importmodule","tag","{[",["string","builtin"]),h.documentclass=g("documentclass","tag","{[",["","atom"]),h.usepackage=g("documentclass","tag","[",["atom"]),h.begin=g("documentclass","tag","[",["atom"]),h.end=g("documentclass","tag","[",["atom"]),h.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=function(a){},this.openBracket=function(a){},this.closeBracket=function(a){}},{startState:function(){return{f:j,cmdState:[]}},copyState:function(a){return{f:a.f,cmdState:a.cmdState.slice(0,a.cmdState.length)}},token:function(a,b){var c=b.f(a,b),d=a.current();return c}}}),CodeMirror.defineMIME("text/x-stex","stex")